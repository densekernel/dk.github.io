<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>densekernel</title>
    <style>
        :root {
            --bg: #fafafa;
            --fg: #0a0a0a;
            --fg-muted: #666;
            --fg-subtle: #888;
            --border: #ddd;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Helvetica, Arial, sans-serif;
            min-height: 100vh;
            background: var(--bg);
            color: var(--fg);
            transition: background 0.3s, color 0.3s;
        }

        canvas {
            display: block;
            width: 100%;
            height: 30vh;
            margin-bottom: 2rem;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        nav {
            padding: 1.5rem 0;
        }

        .logo {
            font-weight: 600;
            font-size: 1.1rem;
            letter-spacing: 0.08em;
            color: var(--fg);
            text-decoration: none;
        }

        .logo:hover {
            opacity: 0.7;
        }

        main {
            padding: 5rem 0 4rem;
        }

        section {
            margin-bottom: 3rem;
        }

        section:last-child {
            margin-bottom: 0;
        }

        .about {
            max-width: 520px;
        }

        .intro {
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.7;
            color: var(--fg-subtle);
        }

        h2 {
            font-weight: 500;
            font-size: 0.8rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--fg-muted);
            margin-bottom: 1.25rem;
        }

        .projects {
            display: flex;
            flex-direction: column;
            border-top: 1px solid var(--border);
        }

        .project {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 1rem;
            padding: 1.25rem 0;
            border-bottom: 1px solid var(--border);
            text-decoration: none;
            color: inherit;
            transition: opacity 0.2s;
        }

        .project:hover {
            opacity: 0.7;
        }

        .project-name {
            font-weight: 400;
            font-size: 1rem;
        }

        .project-info {
            flex: 1;
        }

        .project-desc {
            font-size: 0.875rem;
            color: var(--fg-subtle);
            margin-top: 0.25rem;
        }

        .project-arrow {
            color: var(--fg-muted);
            font-size: 0.9rem;
            transition: transform 0.2s;
        }

        .project:hover .project-arrow {
            transform: translateX(3px);
        }

        .social {
            margin-top: 3rem;
            padding-bottom: 3rem;
        }

        .social-link {
            display: inline-block;
            color: var(--fg-muted);
            transition: color 0.2s;
            margin-right: 1rem;
        }

        .social-link:hover {
            color: var(--fg);
        }

        .social-link svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <nav>
        <div class="container">
            <a href="/" class="logo">densekernel</a>
        </div>
    </nav>
    <canvas id="kde"></canvas>
    <main class="container">
        <section>
            <h2>Projects</h2>
            <div class="projects">
                <a href="https://www.checkstep.com/" target="_blank" rel="noopener" class="project">
                    <div class="project-info">
                        <span class="project-name">Checkstep</span>
                        <p class="project-desc">Raised $10m+ to build a platform to scan 1b+ pieces of UGC for online harms</p>
                    </div>
                    <span class="project-arrow">→</span>
                </a>
                <a href="https://abcdle.com/" target="_blank" rel="noopener" class="project">
                    <div class="project-info">
                        <span class="project-name">Abcdle</span>
                        <p class="project-desc">My Wordle spin-off based on binary search</p>
                    </div>
                    <span class="project-arrow">→</span>
                </a>
                <a href="http://isostarbase.com/" target="_blank" rel="noopener" class="project">
                    <div class="project-info">
                        <span class="project-name">Iso Starbase</span>
                        <p class="project-desc">Isometric map of Starbase</p>
                    </div>
                    <span class="project-arrow">→</span>
                </a>
            </div>
        </section>

        <section class="about">
            <h2>About</h2>
            <p class="intro">Jonathan Manfield. Co-founder of Checkstep, building trust and safety infrastructure. Previously at JP Morgan on Chase UK Card Payments and Morgan Stanley on Realtime Risk systems.</p>
        </section>

        <section class="about">
            <h2>What is Dense Kernel</h2>
            <p class="intro">A concentration of core knowledge. From kernel density estimation in statistics, to the kernel at the heart of an operating system, to the dense kernel of a seed. The essential part, tightly packed. <em>A triple entendre.</em></p>
        </section>

        <div class="social">
            <a href="https://x.com/densekernel" target="_blank" rel="noopener" class="social-link" aria-label="X">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
            </a>
            <a href="https://www.linkedin.com/in/jonathanmanfield/" target="_blank" rel="noopener" class="social-link" aria-label="LinkedIn">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
            </a>
        </div>
    </main>
    <script>
        const canvas = document.getElementById('kde');
        const ctx = canvas.getContext('2d');

        let width, height, grid, maxD, gridCols, gridRows;
        const peaks = [];
        const contourLevels = 10;
        const resolution = 5;
        let contourOpacity = 1;
        let targetOpacity = 1;

        function resize() {
            const dpr = window.devicePixelRatio || 1;
            width = canvas.offsetWidth;
            height = canvas.offsetHeight;
            canvas.width = width * dpr;
            canvas.height = height * dpr;
            ctx.scale(dpr, dpr);
        }

        function initPeaks() {
            peaks.length = 0;
            const numPeaks = Math.ceil((width * height) / 8000);

            for (let i = 0; i < numPeaks; i++) {
                const sigma = 30 + Math.random() * 50;
                peaks.push({
                    x: Math.random() * (width + 150) - 75,
                    y: Math.random() * (height + 150) - 75,
                    sigma,
                    radius: sigma * 3.5,
                    amplitude: 0.4 + Math.random() * 0.6
                });
            }
        }

        function buildGrid() {
            gridCols = Math.ceil(width / resolution);
            gridRows = Math.ceil(height / resolution);
            grid = [];
            maxD = 0;

            for (let j = 0; j <= gridRows; j++) {
                const row = [];
                for (let i = 0; i <= gridCols; i++) {
                    let d = 0;
                    const x = i * resolution;
                    const y = j * resolution;
                    for (const p of peaks) {
                        const dx = x - p.x;
                        const dy = y - p.y;
                        if (dx * dx + dy * dy > p.radius * p.radius) continue;
                        d += p.amplitude * Math.exp(-(dx * dx + dy * dy) / (2 * p.sigma * p.sigma));
                    }
                    if (d > maxD) maxD = d;
                    row.push(d);
                }
                grid.push(row);
            }
        }

        function draw(time) {
            const pulse = 0.9 + 0.1 * Math.sin(time * 0.0004);

            // Smooth opacity transitions
            const fadeSpeed = targetOpacity === 0 ? 0.15 : 0.03;
            contourOpacity += (targetOpacity - contourOpacity) * fadeSpeed;

            ctx.fillStyle = '#fafafa';
            ctx.fillRect(0, 0, width, height);

            ctx.strokeStyle = `rgba(0, 0, 0, ${0.25 * contourOpacity})`;
            ctx.lineWidth = 1;

            // Draw contour lines using marching squares
            for (let level = 1; level <= contourLevels; level++) {
                const threshold = (level / (contourLevels + 1)) * maxD * pulse;

                ctx.beginPath();

                for (let j = 0; j < gridRows; j++) {
                    for (let i = 0; i < gridCols; i++) {
                        const x = i * resolution;
                        const y = j * resolution;

                        const tl = grid[j][i] >= threshold ? 1 : 0;
                        const tr = grid[j][i + 1] >= threshold ? 1 : 0;
                        const br = grid[j + 1][i + 1] >= threshold ? 1 : 0;
                        const bl = grid[j + 1][i] >= threshold ? 1 : 0;

                        const config = tl * 8 + tr * 4 + br * 2 + bl;
                        if (config === 0 || config === 15) continue;

                        const lerp = (va, vb) => {
                            if (Math.abs(vb - va) < 0.0001) return 0.5;
                            return (threshold - va) / (vb - va);
                        };

                        const top = { x: x + lerp(grid[j][i], grid[j][i + 1]) * resolution, y };
                        const right = { x: x + resolution, y: y + lerp(grid[j][i + 1], grid[j + 1][i + 1]) * resolution };
                        const bottom = { x: x + lerp(grid[j + 1][i], grid[j + 1][i + 1]) * resolution, y: y + resolution };
                        const left = { x, y: y + lerp(grid[j][i], grid[j + 1][i]) * resolution };

                        const drawLine = (p1, p2) => {
                            ctx.moveTo(p1.x, p1.y);
                            ctx.lineTo(p2.x, p2.y);
                        };

                        switch (config) {
                            case 1: case 14: drawLine(left, bottom); break;
                            case 2: case 13: drawLine(bottom, right); break;
                            case 3: case 12: drawLine(left, right); break;
                            case 4: case 11: drawLine(top, right); break;
                            case 5: drawLine(left, top); drawLine(bottom, right); break;
                            case 6: case 9: drawLine(top, bottom); break;
                            case 7: case 8: drawLine(left, top); break;
                            case 10: drawLine(top, right); drawLine(left, bottom); break;
                        }
                    }
                }
                ctx.stroke();
            }

            // Draw grid overlay
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.beginPath();
            const gridSpacing = 40;
            for (let x = 0; x <= width; x += gridSpacing) {
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
            }
            for (let y = 0; y <= height; y += gridSpacing) {
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
            }
            ctx.stroke();

            requestAnimationFrame(draw);
        }

        let resizeTimeout;
        window.addEventListener('resize', () => {
            targetOpacity = 0;
            resize();
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                initPeaks();
                buildGrid();
                targetOpacity = 1;
            }, 200);
        });

        resize();
        initPeaks();
        buildGrid();
        requestAnimationFrame(draw);
    </script>
</body>
</html>
